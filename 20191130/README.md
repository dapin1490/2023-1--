# 20191130 GA 설계

## ToC
- [20191130 GA 설계](#20191130-ga-설계)
  - [ToC](#toc)
- [문제](#문제)
- [basic GA 설계](#basic-ga-설계)
  - [basic GA 구조](#basic-ga-구조)
  - [basic GA 구조 요약](#basic-ga-구조-요약)
  - [basic GA 해의 표현](#basic-ga-해의-표현)
  - [basic GA 연산자](#basic-ga-연산자)

# 문제
주어진 그래프를 두 부류로 나누고, 각 부류를 연결하는 간선의 합이 최대가 되게 하라.

# basic GA 설계
1. 사용한 GA 구조(팀원 별 의견 표를 포함할 것)
2. 해의 표현(chromosome design, 팀원 별 의견 표를 포함할 것)
3. 사용한 연산자에 대한 설명(selection, crossover, mutation, replacement 등, 팀원 별 의견 표를 포함할 것)

GA의 과정

```md
1. 랜덤한 해를 생성하고(`P_0`) 각 해의 cost 계산
2. 랜덤한 두 부모를 선택 후 교배(원하는 방식대로 섞기)
    * 낮은 확률로 돌연변이 발생(랜덤하게 뭔가 바뀜)
3. 생성된 자식은 전체 유전자 풀에서 안 좋은 해를 대체함
4. 위의 과정을 반복
5. 특정한 조건 하에 반복을 중단하고 가장 좋은 해를 반환함
```

## basic GA 구조
1. 랜덤 해 생성 및 cost 계산
    1. 노드의 수만큼 A와 B를 각각 50% 확률로 뽑음. A가 뽑힐 확률과 B가 뽑힐 확률이 동일하며, 각 노드마다 뽑히는 사건은 독립적이고, 순서가 유의미하여 모든 해가 서로 다른 해로 간주되기 때문에 모든 해가 균등하게 생성될 확률을 갖는다.
    2. 해가 유효한지 확인  
        * 두 부류는 모두 최소 1개 이상의 노드를 가져야 한다.
        * 두 부류는 최소 1개 이상의 간선으로 서로 연결되어야 한다: 한쪽 부류에 있는 노드가 갖는 모든 간선 중 반대쪽 부류로 이어지는 게 하나라도 있으면 통과
    3. 한 쪽 부류의 모든 노드가 갖는 모든 간선을 검사해 cost 계산: 예를 들어 A 부류에 속한 노드가 갖는 모든 간선 중 B 부류에 속한 노드로 연결되는 간선의 가중치의 합을 계산. 반대로 계산해도 답은 같다(그렇지 않다면 해가 잘못 생성된 것임).
2. 랜덤 부모 선택 후 교배
    1. 부모 선택: 다음 과정을 2번 반복하여 뽑는다.
        1. 중복 여부를 따지지 않고 2^3 ~ 2^5개 사이로(2의 거듭제곱수로) cost를 뽑는다. 이때 뽑히는 cost는 무조건 해당하는 해가 있는 것만 뽑는다.
        2. 뽑힌 cost끼리 토너먼트를 하여 마지막 하나의 cost를 정한다.
        3. 해당 cost에 해당하는 해 중 하나를 랜덤으로 뽑는다.
    2. 교배: 유전자의 각 자리마다 50% 확률로 부모 둘 중 한 쪽의 것을 선택함. 한 번에 하나의 자식만 생성한다.
    3. 돌연변이: 자식 유전자의 각 자리마다 일정 확률로 다시 선택함. 바꾸는 것이 아니라 다시 선택하는 것이므로 바뀌기 전과 똑같을 수 있다. 정확한 확률은 전체 그래프의 노드 수에 비례하며, 평균적으로 0.8% 내외가 되도록 조정했다.
    4. 자식 유효성 검사: 유효하지 않은 해가 생성되었다면 즉시 제거하며 다시 생성하지 않는다.
3. 세대별 대체
    1. 한 세대에서 자식의 수는 전체 풀의 10%가 되도록 한다.
    2. 생성된 자식들은 자신과 cost가 조금 작은 유전자를 대체한다. 만약 대체할 유전자가 없다면 자식이 삭제된다.
        * 만약 한 세대에서 생성된 자식 중 50% 이상이 대체할 수 있는 유전자가 없었다면 진화가 수렴한 것으로 판단하고 진화를 종료한다.
4. 다시 진화가 수렴하거나, 제한시간이 다 되면 cost가 제일 큰 해를 반환한다.

## basic GA 구조 요약
1. 노드의 수만큼 A와 B를 50% 확률로 뽑아 해를 생성하고, 유효한 해인지 검사하면서 cost를 계산하여 부모 집합을 만든다.
2. cost 토너먼트를 2번 진행해 두 부모를 뽑는다. 자식은 해의 각 자리마다 50% 확률로 부모의 유전자 중 하나를 선택한다. 자식은 하나 생성하며, 유효성을 검사해 무효한 것은 바로 제거하고 다시 생성하지 않는다. 돌연변이는 해의 각 자리마다 일정 확률로 값을 재선택함으로써 발생한다.
3. 초기 풀의 유전자 수의 일정 비율만큼 교배를 반복하여 생성된 자식들은 자신보다 cost가 조금 작은 유전자를 대체한다. 대체할 유전자가 없는 경우 제거된다.
4. 한 세대에서 일정 비율 이상의 자식이 대체하지 못하고 제거되거나 제한 시간이 다 되었을 때 보유한 최선의 해를 반환한다.

## basic GA 해의 표현
A와 B 두 가지 기호를 그래프에 존재하는 노드 수만큼 나열하여 문자열 형태로 해를 표현한다. 인덱스는 1부터 시작하는 것으로 취급하며 문자열의 인덱스와 노드의 번호가 같고, 해당 자리의 글자가 해당 노드가 속한 그룹을 의미한다. cost는 두 그룹의 노드를 잇는 가중치의 총합으로 정한다.

## basic GA 연산자
* validation: 모든 해가 생성될 때 그것이 유효한지 검사한다. 두 그룹에 최소 하나 이상의 노드가 포함되고, 두 그룹을 잇는 간선이 최소 하나 이상 존재하는 것을 유효함으로 정의한다.
* selection: cost를 기준으로 토너먼트를 하고, 뽑힌 cost를 갖는 해 중에서 랜덤하게 뽑는다.
* crossover: 해의 각 자리마다 50% 확률로 두 부모의 유전자 중 하나를 선택한다.
* mutation: 해의 각 자리마다 일정 확률로 값을 다시 선택하며, 이전의 값과 똑같을 수 있다. 해의 길이에 비례하여 평균 약 0.8%의 확률로 발생한다.
* replacement: generational GA 방식 이용, 자신보다 cost가 약간 작은 것과 대체한다.